<!DOCTYPE html>
<html>
    <head>
        <title>Programación Infantil 2014-15</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <meta name="msapplication-tap-highlight" content="no" />
        <meta id='viewportIni' name="viewport" content="width =320, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
        <link href="css/jquery.mobile-1.4.2.min.css" rel="stylesheet"/>
        <link href="css/jquery.mobile.icons-1.4.2.css" rel="stylesheet"/>
        <link href="css/estilos.css" rel="stylesheet"/>
        <link href="css/coachMarkStyle.css" rel="stylesheet"/>
        <link rel="shortcut icon" type="image/ico" href="favIcon.png" />

        <link href="css/estilosResponsive.css" rel="stylesheet"/><!-- para la visualizacion responsive -->
        <link href="css/estilosWeb.css" rel="stylesheet"/><!-- para la visualizacion web -->
        <link href="css/jquery.mobile.datepicker.css" rel="stylesheet"/>

        <script src="js/jquery-1.10.2.js"></script>
        <script src="js/jquery-ui-1.10.4.custom.min.js"></script>  
        <script src="js/checkConn.js"></script>



        <script src="js/google.js"></script>
        <script src="js/dataAccess.js"></script>
        <script src="js/cargas.js"></script>
        <script src="js/parseos.js"></script>
        <script src="js/functions.js"></script>
        <script src="js/canvasLoader.js"></script>
        <script src="js/localNotification.js"></script>
        <script src="js/alertas.js"></script>

        <script type="text/javascript" charset="utf-8" src="phonegap.js"></script>
        <script src="js/jquery.mobile-1.4.2.min.js"></script>
        <script src="js/maps.js"></script>
        <script src="js/calendario.js"></script>
        <script src="js/localStorage.min.js"></script>
        <script src="js/session.js"></script>
        <!--<script src="js/notificaciones.js"></script>--->
        <script type="text/javascript" src="js/PushNotification.js"></script>
        <script src="js/ga.js"></script>
        <!-- TestFlight -->
        <!-- MOBISCROLL -->
        <script src="js/mobiscroll.core.js"></script>
        <script src="js/mobiscroll.scroller.js" type="text/javascript"></script>

        <script src="js/mobiscroll.datetime.js" type="text/javascript"></script>
        <script src="js/mobiscroll.select.js" type="text/javascript"></script>

        <script src="js/mobiscroll.scroller.jqm.js" type="text/javascript"></script>
        <script src="js/mobiscroll.scroller.ios.js" type="text/javascript"></script>
        <script src="js/mobiscroll.scroller.android.js" type="text/javascript"></script>
        <script src="js/mobiscroll.scroller.android-ics.js" type="text/javascript"></script>
        <script src="js/mobiscroll.scroller.wp.js" type="text/javascript"></script>

        <script src="js/i18n/mobiscroll.i18n.de.js" type="text/javascript"></script>
        <script src="js/i18n/mobiscroll.i18n.es.js" type="text/javascript"></script>
        <script src="js/i18n/mobiscroll.i18n.fr.js" type="text/javascript"></script>
        <script src="js/i18n/mobiscroll.i18n.hu.js" type="text/javascript"></script>
        <script src="js/i18n/mobiscroll.i18n.it.js" type="text/javascript"></script>
        <script src="js/i18n/mobiscroll.i18n.no.js" type="text/javascript"></script>
        <script src="js/i18n/mobiscroll.i18n.pt-BR.js" type="text/javascript"></script>
        <script src="js/i18n/mobiscroll.i18n.zh.js" type="text/javascript"></script>

        <link href="css/mobiscroll.scroller.css" rel="stylesheet" type="text/css" />
        <link href="css/mobiscroll.scroller.jqm.css" rel="stylesheet" type="text/css" />
        <link href="css/mobiscroll.scroller.android.css" rel="stylesheet" type="text/css" />
        <link href="css/mobiscroll.scroller.android-ics.css" rel="stylesheet" type="text/css" />
        <link href="css/mobiscroll.scroller.ios.css" rel="stylesheet" type="text/css" />
        <link href="css/mobiscroll.scroller.sense-ui.css" rel="stylesheet" type="text/css" />
        <link href="css/mobiscroll.scroller.wp.css" rel="stylesheet" type="text/css" />

        <link href="css/mobiscroll.animation.css" rel="stylesheet" type="text/css" />

        <!--<script src="js/imgTransfer.js"></script>-->
        <script src="js/webBBDD.js"></script>
        <script src="js/rrule.js"></script>
        <script src="js/sincronizacionInicial.js"></script>
        <script src="js/tratamientoFechas.js"></script>
        <script type="text/javascript" charset="utf-8" src="js/storeRedirect.js"></script>
        <script type="text/javascript" charset="utf-8" src="js/QRController.js"></script><!-- Para los QR web -->
        <!--<script type="text/javascript" charset="utf-8" src="js/PushNotification.js"></script>-->
        <!--<script src="http://debug.build.phonegap.com/target/target-script-min.js#lkajsdhfjksahfgjkshadfgh"></script>-->
        <script type="text/javascript">

            if (navigator.appName.indexOf('Explorer') > -1 || navigator.userAgent.indexOf('.NET') > -1) {
                var theDoc = document; // shortcut
                var cssId = 'myCss';  // you could encode the css path itself to generate id..
                var head = theDoc.getElementsByTagName('head')[0];
                var link = theDoc.createElement('link');
                link.id = cssId;
                link.rel = 'stylesheet';
                link.type = 'text/css';
                link.href = 'css/all-ie-only.css';
                link.media = 'all';
                head.appendChild(link);
            }

            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r;
                i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date();
                a = s.createElement(o),
                        m = s.getElementsByTagName(o)[0];
                a.async = 1;
                a.src = g;
                m.parentNode.insertBefore(a, m)
            })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

            ga('create', sessionTrakingGoogle, 'auto');
            ga('create', sessionTrakingGoogle, {
                'cookieDomain': 'none'
            });
            ga('send', 'pageview');

        </script>
        <script type="text/javascript">
            $(function () {

                var curr = new Date().getFullYear();
                var opt = {
                    'date': {
                        preset: 'date',
                        dateOrder: 'd Dmmyy',
                        invalid: {daysOfWeek: [0, 6], daysOfMonth: ['5/1', '12/24', '12/25']}
                    },
                    'datetime': {
                        preset: 'datetime',
                        minDate: new Date(2012, 3, 10, 9, 22),
                        maxDate: new Date(2014, 7, 30, 15, 44),
                        stepMinute: 5
                    },
                    'time': {
                        preset: 'time'
                    },
                    'credit': {
                        preset: 'date',
                        dateOrder: 'mmyy',
                        dateFormat: 'mm/yy',
                        startYear: curr,
                        endYear: curr + 10,
                        width: 100
                    },
                    'select': {
                        preset: 'select'
                    },
                    'select-opt': {
                        preset: 'select',
                        group: true,
                        width: 50
                    }
                }
                var demo = "time";

                if (!demo.match(/select/i)) {
                    $('.demo-test-' + demo).val('');
                }

                $('.demo-test-' + demo).scroller('destroy').scroller($.extend(opt[demo], {
                    theme: "ios7",
                    mode: "scroller",
                    lang: "es",
                    display: "bottom",
                    animate: "fade"
                }));
                //$('.demo').hide();
                $('.demo-' + demo).show();
                //$('#demo').trigger('change');

            });
        </script>

    </head>
    <body id="idBody" onload="cargaInicialOnLoad();
            setTimeout(function () {
                if (sessionSetLoader == true)
                    setLoader('idBody')
            }, 1);">
        <div class="" id='splashDiv' style=""></div>
        <!-- Pagina Principal-->
        <div data-role="page" id="indice" >
            <div data-role="panel" id="menuPrincipal" data-display="overlay" data-theme="b" data-position="right" data-position-fixed="true">
                <ul data-role="listview">
                    <li class="primerElementoMenu">Descubrir</li>
                    <li><a class="cercaMenu" onclick="checkConnection();
                            if (primerFalloConexion == false) {
                                //launchPop();
                            } else {
                                document.location.href = '#ahoraCerca'
                            }" href="#ahoraCerca">Ahora y Cerca</a></li>
                    <li><a class="fechaMenu" onclick="checkConnection();
                            if (primerFalloConexion == false) {
                                //launchPop();
                            } else {
                                document.location.href = '#fecha'
                            }" href="#fecha">Fecha</a></li>
                    <li><a class="lugaresMenu" href="#lugares">Lugares</a></li>
                    <li class='noMostrar'><a class="favoritosMenu " href="#favoritas">Favoritos</a></li>
                    <li><a class="participantesMenu" href="#participantes">Participantes</a></li>
                    <li><a class="tematicasMenu" href="#tematicas">Temáticas</a></li>
                    <li><a class="acercaMenu" href="#pagPagAcercaDe">Acerca de ...</a></li>
                    <!--<li><a onclick="alarmaDePrueba()">pruebas Alarma</a></li>-->
                </ul>
            </div>
            <div data-role="header"  data-position="fixed">
                <h1 class="tituloByKurbana">Ayto. Arroyo de la Encomienda</h1>
                <a  class="ui-btn ui-icon-bars ui-btn-icon-notext ui-btn-right" href="#menuPrincipal">Menú</a>
            </div>
            <div data-role="content">
                <ul class="listadoPropio" id="listadoEventosIndice">
                </ul>
            </div>

        </div>

        <!-- filtro de fecha-->
        <div data-role="page" id="fecha">
            <div data-role="header"  data-position="fixed">
                <a data-role="button" data-rel="back" class="ui-btn ui-icon-carat-l ui-btn-icon-notext"></a>
                <h1 class="fechaMenu">Fecha</h1>
                <a  class="ui-btn ui-icon-home ui-btn-icon-notext ui-btn-right" onclick="goIndice()">Indice</a>
            </div>
            <div data-role="content">

                <div id="zonaCalendarioFiltro">
                    <div id="filtroCalendario"  ></div>
                    <div class="leyendaCalendario "><span class='diaConActividad'>Días con actividades</span></div>
                    <div class="leyendaCalendario"><span class='diaConActividadPermanente'>Días con actividades permanentes</span></div>
                </div>
                <div id="zonaListadoFechasFiltro" class="trOculto">
                    <ul>

                    </ul>
                </div>
            </div>
        </div>
        <!-- Patrocinadores -->
        <div data-role="page" id="pagPatrocinadores">
            <div data-role="header"  data-position="fixed">
                <a data-role="button" data-rel="back" class="ui-btn ui-icon-carat-l ui-btn-icon-notext"></a>
                <h1>Patrocinadores</h1>
                <a  class="ui-btn ui-icon-home ui-btn-icon-notext ui-btn-right" onclick="goIndice()">Indice</a>
            </div>
            <div data-role="content">
                <div class="zonaPatrocinadores"></div>

            </div>
        </div>

        <!-- Etiquetas -->
        <div data-role="page" id="etiquetas">
            <div data-role="header"  data-position="fixed">
                <a data-role="button" data-rel="back" class="ui-btn ui-icon-carat-l ui-btn-icon-notext"></a>
                <h1>Etiquetas</h1>
                <a  class="ui-btn ui-icon-home ui-btn-icon-notext ui-btn-right" onclick="goIndice()">Indice</a>
            </div>
            <div data-role="content">
                <ul  class="listadoPropioEtiquetas" id="listadoEtiquetas" >
                </ul>
            </div>
        </div>

        <!-- Listado de actividades-->
        <div data-role="page" id="actividades">
            <div data-role="panel" id="menuActividades" data-display="overlay" data-theme="b" data-position="right" data-position-fixed="true">
                <ul data-role="listview">
                    <li class="primerElementoMenu">Descubrir</li>
                    <li><a class="cercaMenu" onclick="sessionSegundoFiltro = 1;
                            checkConnection();
                            if (primerFalloConexion == false) {
                                //launchPop();
                            } else {
                                document.location.href = '#ahoraCerca'
                            }" href="#ahoraCerca">Ahora y Cerca</a></li>
                    <li><a class="fechaMenu" onclick="sessionSegundoFiltro = 2;
                            checkConnection();
                            if (primerFalloConexion == false) {
                                //launchPop();
                            } else {
                                document.location.href = '#fecha'
                            }" href="#fecha">Fecha</a></li>
                    <li><a class="lugaresMenu" href="#lugares" onclick="sessionSegundoFiltro = 3">Lugares</a></li>
                    <li class='noMostrar'><a class="favoritosMenu" href="#favoritas" onclick="sessionSegundoFiltro = 4">Favoritos</a></li>
                    <li><a class="participantesMenu" href="#participantes" onclick="sessionSegundoFiltro = 5">Participantes</a></li>
                    <li><a class="tematicasMenu" href="#tematicas" onclick="sessionSegundoFiltro = 6">Temáticas</a></li>
                    <li id="menuEtiquetas" style="display:none" onclick="sessionSegundoFiltro = 7"><a class="etiquetasMenu" href="#etiquetas" onclick="cargaListadoEtiquetas()">Etiquetas</a></li>
                    <li id="menuPatrocinadores" style="display:none" onclick="sessionSegundoFiltro = 8"><a class="PatrocinadoresMenu" href="#pagPatrocinadores" onclick="cargaPatrocinadoresEvento()">Patrocinadores</a></li>
                    <li class="ui-pre-last-child"><a class="inicioMenu"  onClick="goIndice()">Inicio</a></li>
                    <li><a class="acercaMenu" href="#pagPagAcercaDe">Acerca de ...</a></li>
                    <!--<li><a onclick="alarmaDePrueba()">pruebas Alarma</a></li>-->
                </ul>
            </div>
            <div data-role="header"  data-position="fixed">                
                <a data-role="button" data-rel="back" class="ui-btn  ui-icon-carat-l ui-btn-icon-notext" id="backListadoActividades"></a>
                <a  class="ui-btn ui-icon-bars ui-btn-right ui-btn-icon-notext" href="#menuActividades">Menú</a>
                <h1 id="tituloListadoActividades">Actividades</h1>
            </div>
            <div data-role="content">
                <div id="zonaDetalleEvento" class="detalleFiltro" onclick="checkConnection();
                        $.mobile.changePage('#paginaDetalleEvento')">

                </div>
                <div id="zonaDetalleLugar" class="detalleFiltro" onclick="checkConnection();
                        $.mobile.changePage('#paginaDetalleLugar')">

                </div>
                <div id="zonaDetalleParticipante" class="detalleFiltro" onclick="checkConnection();
                        $.mobile.changePage('#paginaDetalleParticipante')">

                </div>
                <div class="descripcionFiltro"></div>
                <div id="zonaDetalleParticipanteParticipa" class="trOculto"><span>Participa en...</span></div>
                <ul id="listadoActividades" >
                </ul>
                <div class="zonaBannerEvento ajusteListadoBanner" id="bannerDelListado"></div>
            </div>
        </div>

        <!-- Detalle de actividad -->
        <div data-role="page" id="detalleActividad">
            <div data-role="header"  data-position="fixed">
                <a data-role="button" data-rel="back" class="ui-btn ui-icon-carat-l ui-btn-icon-notext cssDinamico" id="backDetAct"></a>
                <a data-role="button" href="#indice" style="display:none" class="" id="backDetActFake"></a>

                <h1 id="tituloDetalleActividad">Detalle de actividad</h1>
                <a  class="ui-btn ui-icon-home ui-btn-icon-notext ui-btn-right" onclick="goIndice()">Indice</a>
            </div>
            <div data-role="content">
                <div id="cabeceraDetalleActividad">
                    <div>
                        <table>
                            <tr>
                                <td></td>
                                <td></td>
                            </tr>
                        </table>
                    </div>                    
                </div>
                <div id="entradillaDetalleActividad"></div>
                <div id="zonaPlegadaInfoActiviad"></div>
                <div id="btnLeerMas" onclick="pliegaDespliegaInfo()">Leer más</div>
                <div id="botoneraDetalleActividad"></div>                
                <div id="zonaRecintoDetalleAct"></div>
                <div id="zonaParticipantesDetalleActi"></div>
                <div id="zonaGaleriaDetalleActi"></div>


                <div class="detalleActiPrincipal" style="display: none">
                    <div class="calendario">
                        <div class="fecha">
                            <div class="dia"></div>
                            <div class="mes"></div>
                        </div>
                        <div class="botonera"></div>
                    </div>
                    <div class="datos"></div>
                    <div class='botonDespliegue2 ajusteBotonDespliegueDer'></div>
                </div>
                <div class="descripcionFiltro" style="display: none"></div>
                <div class="imgDetalleActividad" style="display: none"></div>
                <div class="cuerpoDetalleActividad" style="display: none"></div>
                <div id="popShare" style="display:none"></div>
                <div id="popPatrocinadores" style="display:none"></div>
                <div id="popMas" style="display:none"></div>
                <div class="noMostrar" data-role="popup" id="gestorAlertas" data-overlay-theme="b" data-theme="b" data-dismissible="false">
                    <a id="botonCierraPop" href="#" onclick="$('.dwb-c a').click();" data-rel="back" class="ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right">Cerrar</a>
                    <br/>
                    <br/>
                    <span>Antelación</span>
                    <div data-role="fieldcontain" class="demo demo-date demo-datetime demo-time demo-credit">
                        <input name="test" id="selectorAntelacion" class="demo-test-date demo-test-datetime demo-test-time demo-test-credit" />
                    </div>
                    <input type="button" onclick="aceptarAlerta();
                            $('span.dwbw.dwb-c a').click();" value="Aceptar"/>
                </div>
                <div class="zonaBannerEvento ajusteFooterBanner" id="bannerDeLaActividad"></div>
            </div>
        </div>

        <!-- Detalle del evento -->
        <div data-role="page" id="paginaDetalleEvento">
            <div data-role="header"  data-position="fixed">
                <a data-role="button" data-rel="back" class="ui-btn ui-icon-carat-l ui-btn-icon-notext"></a>
                <h1 id="cabeceraDetalleEvento">Detalle del evento</h1>
                <a  class="ui-btn ui-icon-home ui-btn-icon-notext ui-btn-right" onclick="goIndice()">Indice</a>
            </div>
            <div data-role="content">
                <div id="cabeceraInfoDetalleEvento">
                    <div class="fondoDegradadeoEvento">
                        <div></div>
                    </div>
                </div>
                <div id="zonaDetalleEventoPatrocinadores">
                    <img src="images/patrocinadores.png" onclick="cargaPatrocinadoresEvento();
                            checkConnection();

                            document.location = '#pagPatrocinadores'
                         "/>
                </div>
                <div id="zonaDetalleEventoTextos">

                </div>


                <!-- <div class="detalleActiPrincipal">
                     <div class="datosIzquierda evento"></div>
                     <div class='botonDespliegue2 ajusteBotonDespliegueDer '></div>
                     <div class="botonAdmiracionDetalleEvento" onclick="cargaPatrocinadoresEvento();
                 document.location = '#pagPatrocinadores'">
                         <img src="images/btnPatDetEven.png"/>
                     </div>
                 </div>
                 <div class="descripcionEventoDetalle descripcionFiltro"></div>
                 <div class="imgDetalleEvento"></div>
                 <div class="cuerpoDetalleEvento"></div>-->
                <div class="zonaBannerEvento" id="bannerDetalleEvento"></div>
            </div>
        </div>


        <!-- Favoritos-->
        <div class="noMostrar" data-role="page" id="favoritas">
            <div data-role="header"  data-position="fixed">
                <a data-role="button" data-rel="back" class="ui-btn ui-icon-carat-l ui-btn-icon-notext"></a>
                <h1 class="favoritosMenu">Favoritos</h1>
                <a  class="ui-btn ui-icon-home ui-btn-icon-notext ui-btn-right" onclick="goIndice()">Indice</a>
            </div>
            <div data-role="content">
                <div data-role="navbar">
                    <ul>
                        <li><a id="navBarTem" class="ui-btn-active ui-state-persist nomenTemaFavoritos" onclick="sessionTabFavorito = 1;
                                mostrarListadoTematicasFavoritas()">Temáticas</a></li>
                        <li><a id="navBarAct" onclick="sessionTabFavorito = 2;
                                mostrarListadoActividadesFavoritas()">Actividades</a></li>
                    </ul>
                </div>
                <div>
                    <ul id="listadoTematicasFavoritas" >

                    </ul>
                    <ul class="" id="listadoActividadesFavoritas" style="display: none" >

                    </ul>
                </div>
            </div>
        </div>

        <!-- Tematicas-->
        <div data-role="page" id="tematicas">
            <div data-role="header"  data-position="fixed">
                <a data-role="button" data-rel="back" class="ui-btn ui-icon-carat-l ui-btn-icon-notext"></a>
                <h1 class="tematicasMenu">Tematicas</h1>
                <a data-role="button" id="btnAnchorFavTematicas"><img src="images/estrellaNoMarca.png" id="btnFavTematicas" onclick="mostrarTematicasFavoritos(this)"></a>
            </div>
            <div data-role="content">
                <ul  id="listadoTematicas" >
                </ul>
            </div>
        </div>

        <!-- Participantes-->
        <div data-role="page" id="participantes">
            <div data-role="header"  data-position="fixed">
                <a data-role="button" data-rel="back" class="ui-btn ui-icon-carat-l ui-btn-icon-notext"></a>
                <h1 class="participantesMenu">Participantes</h1>
                <a  class="ui-btn ui-icon-home ui-btn-icon-notext ui-btn-right" onclick="goIndice()">Indice</a>
            </div>
            <div data-role="content">
                <ul id="listadoParticipantes">
                </ul>
            </div>
        </div>

        <!-- Participante-->
        <div data-role="page" id="paginaDetalleParticipante">
            <div data-role="header"  data-position="fixed">
                <a data-role="button" id="btnBackDetalleParticipa" data-rel="back" class="ui-btn ui-icon-carat-l ui-btn-icon-notext"></a>
                <h1 class="" id="tituloNombreParticipante">Participantes</h1>
                <a  class="ui-btn ui-icon-home ui-btn-icon-notext ui-btn-right" onclick="goIndice()">Indice</a>
            </div>
            <div data-role="content" class="contenido">
            </div>
        </div>

        <!-- Tiempo y lugar-->
        <div data-role="page" id="ahoraCerca">
            <div data-role="header"  data-position="fixed">
                <a data-role="button" data-rel="back" class="ui-btn ui-icon-carat-l ui-btn-icon-notext"></a>
                <h1 class="cercaMenu">Ahora y Cerca</h1>
                <a  class="ui-btn ui-icon-home ui-btn-icon-notext ui-btn-right" onclick="goIndice()">Indice</a>
            </div>
            <div data-role="content">
                <div data-role="navbar">
                    <ul>
                        <li><a class="ui-btn-active ui-state-persist" onclick="cargaCercaYLugar(1)">1 hora</a></li>
                        <li><a onclick="cargaCercaYLugar(2)">1 día</a></li>
                        <li><a onclick="cargaCercaYLugar(3)">1 semana</a></li>
                    </ul>
                </div>
                <div id="map-canvas">
                    <!-- El mapa se carga aquí ... -->
                </div>
            </div>
        </div>

        <!-- ver lugar-->
        <div data-role="page" id="pagVerLugar">
            <div data-role="header"  data-position="fixed">
                <a data-role="button" data-rel="back" class="ui-btn ui-icon-carat-l ui-btn-icon-notext"></a>
                <h1 class="cercaMenu">Localización</h1>
                <a  class="ui-btn ui-icon-home ui-btn-icon-notext ui-btn-right" onclick="goIndice()">Indice</a>
            </div>
            <div data-role="content">
                <div id="map-canvas2">
                    <!-- El mapa se carga aquí ... -->
                </div>
            </div>
        </div>

        <!-- Acerca de -->
        <div data-role="page" id="pagPagAcercaDe">
            <div data-role="header"  data-position="fixed">
                <a data-role="button" data-rel="back" class="ui-btn ui-icon-carat-l ui-btn-icon-notext"></a>
                <h1 class="acercaMenu">Acerca De</h1>
                <a  class="ui-btn ui-icon-home ui-btn-icon-notext ui-btn-right" onclick="goIndice()">Indice</a>
            </div>
            <div data-role="content">
                <div>
                    <h1>Ayto. Arroyo de la encomienda</h1>
                </div>
            </div>
        </div>

        <!-- Lugares-->
        <div data-role="page" id="lugares">
            <div data-role="header"  data-position="fixed">
                <a data-role="button" data-rel="back" class="ui-btn ui-icon-carat-l ui-btn-icon-notext"></a>
                <h1 class="lugaresMenu">Lugares</h1>
                <a  class="ui-btn ui-icon-home ui-btn-icon-notext ui-btn-right" onclick="goIndice()">Indice</a>
            </div>
            <div data-role="content">
                <ul  id="listadoLugares">
                </ul>
            </div>
        </div>

        <!-- lugar-->
        <div data-role="page" id="paginaDetalleLugar">
            <div data-role="header"  data-position="fixed">
                <a data-role="button" id="btnBackDetalleLugar" data-rel="back" class="ui-btn ui-icon-carat-l ui-btn-icon-notext"></a>
                <h1 class="" id="tituloNombreLugar">Lugar</h1>
                <a  class="ui-btn ui-icon-home ui-btn-icon-notext ui-btn-right" onclick="goIndice()">Indice</a>
            </div>
            <div data-role="content" class="contenido">
            </div>
        </div>

        <div data-role="popup" id="conectionPopUp" style="display:none">
            <p>No hay una conexión de datos disponibles<p>
        </div>
        <div class="coachMark evento" style="display: none">
            <img src="images/coachMarks/event_coachmark_hover.png"/>
        </div>
        <div class="coachMark actividad" style="display: none">
            <img src="images/coachMarks/activity_coachmark_hover.png"/>
        </div>


        <!--<div class='popUpStore' style="display:none" >
            <div class="cajaStore fichaActividad">
                        <table style="text-align: -webkit-center;text-align: center;margin: auto;"><tr><td>
                        <br/>
                <span>¿Quiere descargar la aplicación MundialPadel para su dispositivo?</span>
                </td></tr><tr><td>
                                <br/>
                                <div>
                    <input type="button" value="Descargar" class="aceptar"/>
                    <input type="button" value="Cancelar" class="cancelar"/>
                </div>
                                </td></tr></table>
            </div>
        </div>-->



        <script>

            setTimeout(function () {
                setLoader('idBody');
                $("#canvasLoader").css("background-color", "transparent")
            }, 10)
            function cargaInicialOnLoad() {
                try {
                    $("a[data-rel='back']").touchstart(function () {
                        $(this).addClass('backPresionado');
                    });
                    $("a[data-rel='back']").touchend(function () {
                        $(this).removeClass('backPresionado');
                    });
                    $("a[data-rel='back']").on("vmouseout", function () {
                        $(this).removeClass('backPresionado');
                    });
                    $("a[data-rel='back']").mouseout(function () {
                        $(this).removeClass('backPresionado');
                    });
                    $("a[data-rel='back']").mousedown(function () {
                        $(this).addClass('backPresionado');
                    });
                    $("a[data-rel='back']").mouseup(function () {
                        $(this).removeClass('backPresionado');
                    });
                } catch (e) {
                    console.error("añadiendo eventos a botones back:" + e)
                }
                try {
                    cargaNomenclaturasMenu()
                } catch (e) {
                }
                try {
                    cargaListadoEventos('listadoEventosIndice');
                    //cargaListadoTematicas();
                    cargaListadoParticipantes();
                    cargaListadoLugares();
                    cargaPosProyecto();
                    cargaListadoEtiquetas();
                } catch (e) {
                }
                try {
                    // $('#botonLanzaPopUp').click();
                } catch (e) {

                }

                hideLoader();
            }
            $("#filtroCalendario").datepicker();
            $('#selectorAntelacion').on('change', function () {
                aceptarAlerta();
            });

        </script>
        <script>
            document.addEventListener('deviceready', function () {

                try {
                    try {
                        navigator.device.resetBackButton();
                        navigator.app.overrideBackbutton(true);
                    } catch (exce) {
                    }
                    document.addEventListener('backKeyDown', manejaBack, false);
                    function manejaBack() {
                        if ($.mobile.activePage.is('#indice')) {
                            navigator.app.exitApp();
                        }
                        else {
                            $(".ui-page-active a[data-rel='back']").click()
                        }
                    }
                } catch (err) {
                }
            })

            var pushNotification;
            $("#selectorAntelacion").click(function () {
                $("#selectorAntelacion").mobiscroll('setValue', '01:00');
            });
            function onDeviceReady() {
                $("#selectorAntelacion").mobiscroll('setValue', '01:00');
                var img = new Image();
                img.src = "images/relojMarcado.png";
                var img2 = new Image();
                img.src = "images/corazonMarcado.png";
                var img3 = new Image();
                img.src = "images/estrellaMarcada.png";

                $("#app-status-ul").append('<li>deviceready event received</li>');

                try
                {
                    pushNotification = window.plugins.pushNotification;
                    if (device.platform == 'android' || device.platform == 'Android') {
                        var theDoc = document; // shortcut
                        var cssIdAnd = 'myCssAndroid';  // you could encode the css path itself to generate id..
                        var head = theDoc.getElementsByTagName('head')[0];
                        var link = theDoc.createElement('link');
                        link.id = cssIdAnd;
                        link.rel = 'stylesheet';
                        link.type = 'text/css';
                        link.href = 'css/android-only.css';
                        link.media = 'all';
                        head.appendChild(link);
                        $("#app-status-ul").append('<li>registering android</li>');
                        //pushNotification.register(successHandler, errorHandler, {"senderID": "629144394569", "ecb": "onNotificationGCM"});		// required!
                        pushNotification.register(successHandler, errorHandler, {"senderID": "269215128011", "ecb": "onNotificationGCM"});		// required!
                    } else {
                        $("#app-status-ul").append('<li>registering iOS</li>');
                        pushNotification.register(tokenHandler, errorHandler, {"badge": "true", "sound": "true", "alert": "true", "ecb": "onNotificationAPN"});	// required!
                    }
                }
                catch (err)
                {
                    txt = "There was an error on this page.\n\n";
                    txt += "Error description: " + err.message + "\n\n";
                    console.error(txt);
                }
                setTimeout(hideLoader(), 1);
            }

            function onPushActi(id) {
                setLoader('idBody');
                setTimeout(function () {
                    cargarActividad(id);
                    document.location.href = "#detalleActividad";
                    hideLoader();
                }, 1);
            }

            function onPushTema(id) {
                setLoader('idBody');
                setTimeout(function () {
                    resetFiltros();
                    sessionFiltroTematica = id;
                    cargaListadoActividades();
                    document.location.href = "#actividades"
                }, 1);
            }
            // handle APNS notifications for iOS
            function onNotificationAPN(e) {
                console.log(e)
                if (e.actividad) {
                    onPushActi(e.actividad);
                }
                if (e.tematica) {
                    onPushTema(e.tematica)
                }
                if (e.alert) {
                    $("#app-status-ul").append('<li>push-notification: ' + e.alert + '</li>');
                    navigator.notification.alert(e.alert);
                }

                if (e.sound) {
                    var snd = new Media(e.sound);
                    snd.play();
                }

                if (e.badge) {
                    pushNotification.setApplicationIconBadgeNumber(successHandler, e.badge);
                }
            }

            // handle GCM notifications for Android
            function onNotificationGCM(e) {
                $("#app-status-ul").append('<li>EVENT -> RECEIVED:' + e.event + '</li>');

                switch (e.event)
                {
                    case 'registered':
                        if (e.regid.length > 0)
                        {
                            $("#app-status-ul").append('<li>REGISTERED -> REGID:' + e.regid + "</li>");
                            // Your GCM push server needs to know the regID before it can push to this device
                            // here is where you might want to send it the regID for later use.
                            //console.log("regID = " + e.regid);

                            sessionPushToken = e.regid;
                            registro();
                        }
                        break;

                    case 'message':
                        // if this flag is set, this notification happened while we were in the foreground.
                        // you might want to play a sound to get the user's attention, throw up a dialog, etc.
                        //console.log(e)
                        if (e.foreground)
                        {
                            $("#app-status-ul").append('<li>--INLINE NOTIFICATION--' + '</li>');

                            // if the notification contains a soundname, play it.
                            var my_media = new Media("/android_asset/www/" + e.soundname);
                            my_media.play();
                        }
                        else
                        {	// otherwise we were launched because the user touched a notification in the notification tray.
                            if (e.coldstart)
                                $("#app-status-ul").append('<li>--COLDSTART NOTIFICATION--' + '</li>');
                            else
                                $("#app-status-ul").append('<li>--BACKGROUND NOTIFICATION--' + '</li>');
                        }
                        if (e.payload.actividad) {
                            onPushActi(e.payload.actividad);
                        }
                        if (e.payload.tematica) {
                            onPushTema(e.payload.tematica);
                        }
                        console.log(e.payload)
                        $("#app-status-ul").append('<li>MESSAGE -> MSG: ' + e.payload.message + '</li>');
                        $("#app-status-ul").append('<li>MESSAGE -> MSGCNT: ' + e.payload.msgcnt + '</li>');
                        break;

                    case 'error':
                        $("#app-status-ul").append('<li>ERROR -> MSG:' + e.msg + '</li>');
                        break;

                    default:
                        $("#app-status-ul").append('<li>EVENT -> Unknown, an event was received and we do not know what it is</li>');
                        break;
                }
            }

            function tokenHandler(result) {
                $("#app-status-ul").append('<li>token: ' + result + '</li>');
                sessionPushToken = result;
                registro();

                //alert(sessionPushToken)
                // Your iOS push server needs to know the token before it can push to this device
                // here is where you might want to send it the token for later use.
            }

            function successHandler(result) {
                $("#app-status-ul").append('<li>success:' + result + '</li>');
            }

            function errorHandler(error) {

                $("#app-status-ul").append('<li>error:' + error + '</li>');
            }


            $('.botonDespliegue2').click(function (e) {
                e.preventDefault();
                if (!$(".descripcionFiltro").hasClass('descripcionFiltroDesplegada')) {
                    $(".descripcionFiltro").addClass('descripcionFiltroDesplegada');
                } else {
                    $(".descripcionFiltro").removeClass('descripcionFiltroDesplegada');
                }
                if (!e)/*IMPRTANTE: detiene la propagacion*/
                    var e = window.event;
                e.cancelBubble = true;
                if (e.stopPropagation)
                    e.stopPropagation();
            });
            $("#menuActividades").on("panelbeforeopen", function () {
                $("body").addClass("bloqueaScroll");
                document.getElementById("actividades").style.position = "fixed"
            });

            $("#menuActividades").on("panelbeforeclose", function () {
                $("body").removeClass("bloqueaScroll");
                document.getElementById("actividades").style.position = ""
            });
            $("#menuPrincipal").on("panelbeforeopen", function () {
                $("body").addClass("bloqueaScroll");
                document.getElementById("indice").style.position = "fixed"
            });

            $("#menuPrincipal").on("panelbeforeclose", function () {
                $("body").removeClass("bloqueaScroll");
                document.getElementById("indice").style.position = ""
            });


            $("#menuPrincipal").click(function () {
                $("#menuPrincipal").panel("close");
            })
            $("#menuActividades").click(function () {
                $("#menuActividades").panel("close");
            })

            document.addEventListener('deviceready', onDeviceReady, true);
            hideLoader()

            try {//lanzar el popUp de ir a store si es mobile
                if (navigator.userAgent.match(/Android|iPhone|IEMobile/i)) {
                    //aqui hay que comprobar si se debe mostrar el popUp desgún el server y de ser asi cambiar el texto

                    cargaInfoDescarga();
                } else {
                    $('.popUpStore').remove();
                }
            } catch (ex) {
            }
            try {
                var primerActividad = getData('primerActividadCoachMark');
                if (primerActividad == null) {
                } else {
                    $(".coachMark.actividad").remove();
                }
                var primerEvento = getData('primerEventoCoachMark');
                if (primerEvento == null) {
                } else {
                    $(".coachMark.evento").remove();
                }
            } catch (ex) {
            }

        </script>

        <script type="text/javascript">
            sincroBorrados();
            if ($(window).width() >= 768 && !navigator.userAgent.match(/iPhone/i)) {
                $('head').append('<meta id="viewport" name="viewport" content="width=768">');
                $(".coachMark.evento img").attr("src", "images/coachMarks/event_coachmark_ipad.png")
                $(".coachMark.evento").addClass("ipadCoach")
            } else {
                $('head').append('<meta id="viewport" name="viewport" content="width=320">');
            }

        </script>
        <script src="js/coachMarkLib.js"></script>
        <div id="home" style="display:none">
            <div id="app-status-div">
                <ul id="app-status-ul">
                    <li>Cordova PushNotification Plugin Demo</li>
                </ul>
            </div>
        </div>
    </body>
</html>
